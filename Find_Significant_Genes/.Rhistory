head(by_condition_sig_genes)
#write.csv(by_condition_sig_genes,"./significant_genes/pivalue_inverse_prod.csv", row.names = FALSE)
filtered_smalled_pi<- function(col,threshold){
col <- ifelse(col< threshold, 1, col)
return(col)
}
#considering hemo dilution, non_hemo
#take inverse of the pi_value and multiple them, the extremly small values will be amplified, so that the product will be big.
#The smaller the product of pi_values, the more significant the gene is.
combined <-combined %>% mutate(c1_5_7 =filtered_smalled_pi(c1)*filtered_smalled_pi(c5)*filtered_smalled_pi(c7))
filtered_smalled_pi<- function(col,threshold=0.5){
col <- ifelse(col< threshold, 1, col)
return(col)
}
#considering hemo dilution, non_hemo
#take inverse of the pi_value and multiple them, the extremly small values will be amplified, so that the product will be big.
#The smaller the product of pi_values, the more significant the gene is.
combined <-combined %>% mutate(c1_5_7 =filtered_smalled_pi(c1)*filtered_smalled_pi(c5)*filtered_smalled_pi(c7))
combined <-combined %>% mutate(c9_12_15 =filtered_smalled_pi(c9)*filtered_smalled_pi(c12)*filtered_smalled_pi(c15))
combined <-combined %>% mutate(c10_18_19=filtered_smalled_pi(c10)*filtered_smalled_pi(c18)*filtered_smalled_pi(c19))
head(combined)
combined<- list_of_comparison[[1]]
for(i in 2:length(list_of_comparison)){
subdata= list_of_comparison[[i]] %>% select(ENSEMBL,pi_value)
combined<- combined %>% left_join(subdata,by="ENSEMBL")
}
#combine ranking
combined <- select(combined,-c(AveExpr,t,adj.P.Val,logFC,P.Value))
for(i in 8:26){
names(combined)[i]<-paste0("c",i-7)
}
combined<- list_of_comparison[[1]]
for(i in 2:length(list_of_comparison)){
subdata= list_of_comparison[[i]] %>% select(ENSEMBL,pi_value)
combined<- combined %>% left_join(subdata,by="ENSEMBL")
}
#combine ranking
combined <- select(combined,-c(AveExpr,t,adj.P.Val,logFC,P.Value))
head(combined)
combined<- list_of_comparison[[1]]
for(i in 2:length(list_of_comparison)){
subdata= list_of_comparison[[i]] %>% select(ENSEMBL,pi_value)
combined<- combined %>% left_join(subdata,by="ENSEMBL")
}
#combine ranking
combined <- select(combined,-c(AveExpr,t,adj.P.Val))
for(i in 8:26){
names(combined)[i]<-paste0("c",i-7)
}
combined<- select(combined,-c(c1))
names(combined)[7]<-"c1"
head(combined)
combined<- list_of_comparison[[1]]
for(i in 2:length(list_of_comparison)){
subdata= list_of_comparison[[i]] %>% select(ENSEMBL,pi_value)
combined<- combined %>% left_join(subdata,by="ENSEMBL")
}
#combine ranking
combined <- select(combined,-c(AveExpr,t,adj.P.Val))
for(i in 8:26){
names(combined)[i]<-paste0("c",i-7)
}
combined<- select(combined,-c(c1,logFC,P.Value))
names(combined)[5]<-"c1"
head(combined)
filtered_smalled_pi<- function(col,threshold=0.5){
col <- ifelse(col< threshold, 1, col)
return(col)
}
#considering hemo dilution, non_hemo
#take inverse of the pi_value and multiple them, the extremly small values will be amplified, so that the product will be big.
#The smaller the product of pi_values, the more significant the gene is.
combined <-combined %>% mutate(c1_5_7 =filtered_smalled_pi(c1)*filtered_smalled_pi(c5)*filtered_smalled_pi(c7))
combined <-combined %>% mutate(c9_12_15 =filtered_smalled_pi(c9)*filtered_smalled_pi(c12)*filtered_smalled_pi(c15))
combined <-combined %>% mutate(c10_18_19=filtered_smalled_pi(c10)*filtered_smalled_pi(c18)*filtered_smalled_pi(c19))
head(combined)
#considering hemo dilution, non_hemo
#take inverse of the pi_value and multiple them, the extremly small values will be amplified, so that the product will be big.
#The smaller the product of pi_values, the more significant the gene is.
combined <-combined %>% mutate(c1_5_7 =filtered_smalled_pi(c1)*filtered_smalled_pi(c5)*filtered_smalled_pi(c7))
combined <-combined %>% mutate(c9_12_15 =filtered_smalled_pi(c9)*filtered_smalled_pi(c12)*filtered_smalled_pi(c15))
combined <-combined %>% mutate(c10_18_19=filtered_smalled_pi(c10)*filtered_smalled_pi(c18)*filtered_smalled_pi(c19))
head(combined)
rank_by_157<-combined %>% arrange(desc(c1_5_7))
rank_by_91215<-combined %>% arrange(desc(c9_12_15))
rank_by_101819<-combined %>% arrange(desc(c10_18_19))
sig_genes_by_c157<-rank_by_157$ENSEMBL[1:100]
gene_symb_by_c157<-rank_by_157$SYMBOL[1:100]
sig_genes_by_c91215<-rank_by_91215$ENSEMBL[1:100]
gene_symb_by_c91215<-rank_by_157$SYMBOL[1:100]
sig_genes_by_c101819<-rank_by_101819$ENSEMBL[1:100]
gene_symb_by_c101819<-rank_by_101819$SYMBOL[1:100]
by_condition_sig_genes <- data.frame(sig_genes_by_c157,gene_symb_by_c157,sig_genes_by_c91215,gene_symb_by_c91215,sig_genes_by_c101819,gene_symb_by_c101819)
head(by_condition_sig_genes)
#write.csv(by_condition_sig_genes,"./significant_genes/pivalue_inverse_prod.csv", row.names = FALSE)
rank_by_157<-combined %>% arrange(desc(c1_5_7))
rank_by_91215<-combined %>% arrange(desc(c9_12_15))
rank_by_101819<-combined %>% arrange(desc(c10_18_19))
sig_genes_by_c157<-rank_by_157$ENSEMBL[1:100]
gene_symb_by_c157<-rank_by_157$SYMBOL[1:100]
sig_genes_by_c91215<-rank_by_91215$ENSEMBL[1:100]
gene_symb_by_c91215<-rank_by_157$SYMBOL[1:100]
sig_genes_by_c101819<-rank_by_101819$ENSEMBL[1:100]
gene_symb_by_c101819<-rank_by_101819$SYMBOL[1:100]
by_condition_sig_genes <- data.frame(sig_genes_by_c157,gene_symb_by_c157,sig_genes_by_c91215,gene_symb_by_c91215,sig_genes_by_c101819,gene_symb_by_c101819)
head(by_condition_sig_genes)
write.csv(by_condition_sig_genes,"./significant_genes/pivalue_inverse_prod.csv", row.names = FALSE)
install.packages("biomaRt")
knitr::opts_chunk$set(echo = TRUE)
library(devtools)
library(devtools)
install_github('andreacirilloac/updateR')
install.packages("biomaRt")
getRversion()
install.packages("biomaRt")
knitr::opts_chunk$set(echo = TRUE)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("biomaRt")
BiocManager::install("biomaRt")
library("biomaRt")
ensembl = useMart("ensembl",dataset="hsapiens_gene_ensembl")
searchAttributes(mart = ensembl, pattern = "chromosome")
searchAttributes(mart = ensembl, pattern = "chromosome.*location")
searchAttributes(mart = ensembl, pattern = "location")
searchFilters(mart = ensembl, pattern = "ensembl.*id")
searchFilters(mart = ensembl, pattern = "chromosome")
searchAttributes(mart = ensembl, pattern = "chromosome_name")
getBM(attributes=c("ensembl_gene_id ", 'chromosome_name'),
filters = 'ensembl_gene_id ',
values = 'ENSG00000101974',
mart = ensembl)
getBM(attributes=c("ensembl_gene_id ", 'chromosome_name'),
filters = 'ensembl_gene_id ',
values = 'ENSG00000101974',
mart = ensembl)
searchAttributes(mart = ensembl, pattern = "chromosome")
getBM(attributes=c("ensembl_gene_id ", 'chromosome_name'),
filters = 'ensembl_gene_id ',
values = '00000101974',
mart = ensembl)
searchFilters(mart = ensembl, pattern = "ENTREZID")
searchFilters(mart = ensembl, pattern = "entrezid")
searchFilters(mart = ensembl, pattern = "entre")
getBM(attributes=c("ensembl_gene_id ", 'chromosome_name'),
filters = 'entrezgene_id ',
values = '286410',
mart = ensembl)
getBM(attributes='chromosome_name',
filters = 'entrezgene_id ',
values = '286410',
mart = ensembl)
getBM(attributes=c('entrezgene_id ','chromosome_name'),
filters = 'entrezgene_id ',
values = '286410',
mart = ensembl)
getBM(attributes=c('entrezgene_id ','chromosome_name'),
values = '286410',
mart = ensembl)
genes <- getBM(
attributes=c("hgnc_symbol","entrezgene","chromosome_name","start_position","end_position"),
mart = mart)
genes <- getBM(
attributes=c("hgnc_symbol","entrezgene","chromosome_name","start_position","end_position"),
mart = ensembl)
genes <- getBM(attributes=c("hgnc_symbol","entrezgene","chromosome_name","start_position","end_position"),mart = ensembl)
mapping <- getBM(attributes = c("ensembl_gene_id", "hgnc_symbol"), mart = ensembl)
head(mapping)
getBM(attributes=c("entrezgene_id","chromosome_name"),
values = '286410',
mart = ensembl)
searchFilters(mart = ensembl, pattern = "ensembl")
getBM(attributes=c("ensembl_gene_id","chromosome_name"), filter="ensembl_gene_id"
values ="ENSG00000101974" ,
getBM(attributes=c("ensembl_gene_id","chromosome_name"), filter="ensembl_gene_id"
,values ="ENSG00000101974" ,
mart = ensembl)
C1_CMS_PREHEM_POSTEXvsCMS_PREHEM_PREEX<- read.csv(file ='20200218_simonson_rnaseq_deliverables/C1_CMS_PREHEM_POSTEXvsCMS_PREHEM_PREEX/20191108_simonson_rnaseq_differential_expression_20200218093629_C1_CMS_PREHEM_POSTEXvsCMS_PREHEM_PREEX_AllGenes.csv')
C1_CMS_PREHEM_POSTEXvsCMS_PREHEM_PREEX<- read.csv(file ='20200218_simonson_rnaseq_deliverables/C1_CMS_PREHEM_POSTEXvsCMS_PREHEM_PREEX/20191108_simonson_rnaseq_differential_expression_20200218093629_C1_CMS_PREHEM_POSTEXvsCMS_PREHEM_PREEX_AllGenes.csv')
ensembl_id<-C1_CMS_PREHEM_POSTEXvsCMS_PREHEM_PREEX$ENSEMBL
chromosome_info<-getBM(attributes=c("ensembl_gene_id","chromosome_name","start_position", "end_position"), filter="ensembl_gene_id" ,values =ensembl_id, mart = ensembl)
head(chromosome_info)
#write the relevent chromosome information to csv
write.csv(chromosome_info,"./significant_genes/chromosome_info.csv", row.names = FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
setwd("~/Desktop/data for ipa analysis")
data<-read.csv(file="comparisons_master_table.csv")
c1_sig<-data%>%select(ENSEMBL,logFC_C1,pi_C1,P_C1)%>%arrange(desc(pi_C1)) %>% slice(1:200)
dim(c1_sig)
head(c1_sig)
c1_sig<-data%>%select(ENSEMBL,logFC_C1,pi_C1,P_C1)%>%arrange(desc(pi_C1)) %>% slice(1:200)
c2_sig<-data%>%select(ENSEMBL,logFC_C2,pi_C2,P_C2)%>%arrange(desc(pi_C2)) %>% slice(1:200)
c3_sig<-data%>%select(ENSEMBL,logFC_C3,pi_C3,P_C3)%>%arrange(desc(pi_C3)) %>% slice(1:200)
c4_sig<-data%>%select(ENSEMBL,logFC_C4,pi_C4,P_C4)%>%arrange(desc(pi_C4)) %>% slice(1:200)
c5_sig<-data%>%select(ENSEMBL,logFC_C5,pi_C5,P_C5)%>%arrange(desc(pi_C5)) %>% slice(1:200)
c6_sig<-data%>%select(ENSEMBL,logFC_C6,pi_C6,P_C6)%>%arrange(desc(pi_C6)) %>% slice(1:200)
c7_sig<-data%>%select(ENSEMBL,logFC_C7,pi_C7,P_C7)%>%arrange(desc(pi_C7)) %>% slice(1:200)
c8_sig<-data%>%select(ENSEMBL,logFC_C8,pi_C8,P_C8)%>%arrange(desc(pi_C8)) %>% slice(1:200)
c9_sig<-data%>%select(ENSEMBL,logFC_C9,pi_C9,P_C9)%>%arrange(desc(pi_C9)) %>% slice(1:200)
c10_sig<-data%>%select(ENSEMBL,logFC_C10,pi_C10,P_C10)%>%arrange(desc(pi_C10)) %>% slice(1:200)
c11_sig<-data%>%select(ENSEMBL,logFC_C11,pi_C11,P_C11)%>%arrange(desc(pi_C11)) %>% slice(1:200)
c12_sig<-data%>%select(ENSEMBL,logFC_C12,pi_C12,P_C12)%>%arrange(desc(pi_C12)) %>% slice(1:200)
c13_sig<-data%>%select(ENSEMBL,logFC_C13,pi_C13,P_C13)%>%arrange(desc(pi_C13)) %>% slice(1:200)
c14_sig<-data%>%select(ENSEMBL,logFC_C14,pi_C14,P_C14)%>%arrange(desc(pi_C14)) %>% slice(1:200)
c15_sig<-data%>%select(ENSEMBL,logFC_C15,pi_C15,P_C15)%>%arrange(desc(pi_C15)) %>% slice(1:200)
c16_sig<-data%>%select(ENSEMBL,logFC_C16,pi_C16,P_C16)%>%arrange(desc(pi_C16)) %>% slice(1:200)
c17_sig<-data%>%select(ENSEMBL,logFC_C17,pi_C17,P_C17)%>%arrange(desc(pi_C17)) %>% slice(1:200)
c18_sig<-data%>%select(ENSEMBL,logFC_C18,pi_C18,P_C18)%>%arrange(desc(pi_C18)) %>% slice(1:200)
c19_sig<-data%>%select(ENSEMBL,logFC_C19,pi_C19,P_C19)%>%arrange(desc(pi_C19)) %>% slice(1:200)
head(c19_sig)
c1_sig<-data%>%select(ENSEMBL,logFC_C1,pi_C1,P_C1)%>%arrange(desc(pi_C1)) %>% slice(1:200)%>%select(-c(pi_C1))
c2_sig<-data%>%select(ENSEMBL,logFC_C2,pi_C2,P_C2)%>%arrange(desc(pi_C2)) %>% slice(1:200)
c3_sig<-data%>%select(ENSEMBL,logFC_C3,pi_C3,P_C3)%>%arrange(desc(pi_C3)) %>% slice(1:200)
c4_sig<-data%>%select(ENSEMBL,logFC_C4,pi_C4,P_C4)%>%arrange(desc(pi_C4)) %>% slice(1:200)
c5_sig<-data%>%select(ENSEMBL,logFC_C5,pi_C5,P_C5)%>%arrange(desc(pi_C5)) %>% slice(1:200)
c6_sig<-data%>%select(ENSEMBL,logFC_C6,pi_C6,P_C6)%>%arrange(desc(pi_C6)) %>% slice(1:200)
c7_sig<-data%>%select(ENSEMBL,logFC_C7,pi_C7,P_C7)%>%arrange(desc(pi_C7)) %>% slice(1:200)
c8_sig<-data%>%select(ENSEMBL,logFC_C8,pi_C8,P_C8)%>%arrange(desc(pi_C8)) %>% slice(1:200)
c9_sig<-data%>%select(ENSEMBL,logFC_C9,pi_C9,P_C9)%>%arrange(desc(pi_C9)) %>% slice(1:200)
c10_sig<-data%>%select(ENSEMBL,logFC_C10,pi_C10,P_C10)%>%arrange(desc(pi_C10)) %>% slice(1:200)
c11_sig<-data%>%select(ENSEMBL,logFC_C11,pi_C11,P_C11)%>%arrange(desc(pi_C11)) %>% slice(1:200)
c12_sig<-data%>%select(ENSEMBL,logFC_C12,pi_C12,P_C12)%>%arrange(desc(pi_C12)) %>% slice(1:200)
c13_sig<-data%>%select(ENSEMBL,logFC_C13,pi_C13,P_C13)%>%arrange(desc(pi_C13)) %>% slice(1:200)
c14_sig<-data%>%select(ENSEMBL,logFC_C14,pi_C14,P_C14)%>%arrange(desc(pi_C14)) %>% slice(1:200)
c15_sig<-data%>%select(ENSEMBL,logFC_C15,pi_C15,P_C15)%>%arrange(desc(pi_C15)) %>% slice(1:200)
c16_sig<-data%>%select(ENSEMBL,logFC_C16,pi_C16,P_C16)%>%arrange(desc(pi_C16)) %>% slice(1:200)
c17_sig<-data%>%select(ENSEMBL,logFC_C17,pi_C17,P_C17)%>%arrange(desc(pi_C17)) %>% slice(1:200)
c18_sig<-data%>%select(ENSEMBL,logFC_C18,pi_C18,P_C18)%>%arrange(desc(pi_C18)) %>% slice(1:200)
c19_sig<-data%>%select(ENSEMBL,logFC_C19,pi_C19,P_C19)%>%arrange(desc(pi_C19)) %>% slice(1:200)
head(c1_sig)
c1_sig<-data%>%select(ENSEMBL,logFC_C1,pi_C1,P_C1)%>%arrange(desc(pi_C1)) %>% slice(1:200)
c2_sig<-data%>%select(ENSEMBL,logFC_C2,pi_C2,P_C2)%>%arrange(desc(pi_C2)) %>% slice(1:200)
c3_sig<-data%>%select(ENSEMBL,logFC_C3,pi_C3,P_C3)%>%arrange(desc(pi_C3)) %>% slice(1:200)
c4_sig<-data%>%select(ENSEMBL,logFC_C4,pi_C4,P_C4)%>%arrange(desc(pi_C4)) %>% slice(1:200)
c5_sig<-data%>%select(ENSEMBL,logFC_C5,pi_C5,P_C5)%>%arrange(desc(pi_C5)) %>% slice(1:200)
c6_sig<-data%>%select(ENSEMBL,logFC_C6,pi_C6,P_C6)%>%arrange(desc(pi_C6)) %>% slice(1:200)
c7_sig<-data%>%select(ENSEMBL,logFC_C7,pi_C7,P_C7)%>%arrange(desc(pi_C7)) %>% slice(1:200)
c8_sig<-data%>%select(ENSEMBL,logFC_C8,pi_C8,P_C8)%>%arrange(desc(pi_C8)) %>% slice(1:200)
c9_sig<-data%>%select(ENSEMBL,logFC_C9,pi_C9,P_C9)%>%arrange(desc(pi_C9)) %>% slice(1:200)
c10_sig<-data%>%select(ENSEMBL,logFC_C10,pi_C10,P_C10)%>%arrange(desc(pi_C10)) %>% slice(1:200)
c11_sig<-data%>%select(ENSEMBL,logFC_C11,pi_C11,P_C11)%>%arrange(desc(pi_C11)) %>% slice(1:200)
c12_sig<-data%>%select(ENSEMBL,logFC_C12,pi_C12,P_C12)%>%arrange(desc(pi_C12)) %>% slice(1:200)
c13_sig<-data%>%select(ENSEMBL,logFC_C13,pi_C13,P_C13)%>%arrange(desc(pi_C13)) %>% slice(1:200)
c14_sig<-data%>%select(ENSEMBL,logFC_C14,pi_C14,P_C14)%>%arrange(desc(pi_C14)) %>% slice(1:200)
c15_sig<-data%>%select(ENSEMBL,logFC_C15,pi_C15,P_C15)%>%arrange(desc(pi_C15)) %>% slice(1:200)
c16_sig<-data%>%select(ENSEMBL,logFC_C16,pi_C16,P_C16)%>%arrange(desc(pi_C16)) %>% slice(1:200)
c17_sig<-data%>%select(ENSEMBL,logFC_C17,pi_C17,P_C17)%>%arrange(desc(pi_C17)) %>% slice(1:200)
c18_sig<-data%>%select(ENSEMBL,logFC_C18,pi_C18,P_C18)%>%arrange(desc(pi_C18)) %>% slice(1:200)
c19_sig<-data%>%select(ENSEMBL,logFC_C19,pi_C19,P_C19)%>%arrange(desc(pi_C19)) %>% slice(1:200)
head(c1_sig)
c1_sig<-data%>%select(ENSEMBL,logFC_C1,pi_C1,P_C1)%>%arrange(desc(pi_C1)) %>% slice(1:200)%>%select(-c(pi_C1))
c2_sig<-data%>%select(ENSEMBL,logFC_C2,pi_C2,P_C2)%>%arrange(desc(pi_C2)) %>% slice(1:200) %>%select(-c(pi_C2))
c3_sig<-data%>%select(ENSEMBL,logFC_C3,pi_C3,P_C3)%>%arrange(desc(pi_C3)) %>% slice(1:200) %>%select(-c(pi_C3))
c4_sig<-data%>%select(ENSEMBL,logFC_C4,pi_C4,P_C4)%>%arrange(desc(pi_C4)) %>% slice(1:200) %>%select(-c(pi_C4))
c5_sig<-data%>%select(ENSEMBL,logFC_C5,pi_C5,P_C5)%>%arrange(desc(pi_C5)) %>% slice(1:200) %>%select(-c(pi_C5))
c6_sig<-data%>%select(ENSEMBL,logFC_C6,pi_C6,P_C6)%>%arrange(desc(pi_C6)) %>% slice(1:200) %>%select(-c(pi_C6))
c7_sig<-data%>%select(ENSEMBL,logFC_C7,pi_C7,P_C7)%>%arrange(desc(pi_C7)) %>% slice(1:200) %>%select(-c(pi_C7))
c8_sig<-data%>%select(ENSEMBL,logFC_C8,pi_C8,P_C8)%>%arrange(desc(pi_C8)) %>% slice(1:200) %>%select(-c(pi_C8))
c9_sig<-data%>%select(ENSEMBL,logFC_C9,pi_C9,P_C9)%>%arrange(desc(pi_C9)) %>% slice(1:200) %>%select(-c(pi_C9))
c10_sig<-data%>%select(ENSEMBL,logFC_C10,pi_C10,P_C10)%>%arrange(desc(pi_C10)) %>% slice(1:200) %>%select(-c(pi_C10))
c11_sig<-data%>%select(ENSEMBL,logFC_C11,pi_C11,P_C11)%>%arrange(desc(pi_C11)) %>% slice(1:200) %>%select(-c(pi_C11))
c12_sig<-data%>%select(ENSEMBL,logFC_C12,pi_C12,P_C12)%>%arrange(desc(pi_C12)) %>% slice(1:200) %>%select(-c(pi_C12))
c13_sig<-data%>%select(ENSEMBL,logFC_C13,pi_C13,P_C13)%>%arrange(desc(pi_C13)) %>% slice(1:200) %>%select(-c(pi_C13))
c14_sig<-data%>%select(ENSEMBL,logFC_C14,pi_C14,P_C14)%>%arrange(desc(pi_C14)) %>% slice(1:200) %>%select(-c(pi_C14))
c15_sig<-data%>%select(ENSEMBL,logFC_C15,pi_C15,P_C15)%>%arrange(desc(pi_C15)) %>% slice(1:200) %>%select(-c(pi_C15))
c16_sig<-data%>%select(ENSEMBL,logFC_C16,pi_C16,P_C16)%>%arrange(desc(pi_C16)) %>% slice(1:200) %>%select(-c(pi_C16))
c17_sig<-data%>%select(ENSEMBL,logFC_C17,pi_C17,P_C17)%>%arrange(desc(pi_C17)) %>% slice(1:200) %>%select(-c(pi_C17))
c18_sig<-data%>%select(ENSEMBL,logFC_C18,pi_C18,P_C18)%>%arrange(desc(pi_C18)) %>% slice(1:200)%>%select(-c(pi_C18))
c19_sig<-data%>%select(ENSEMBL,logFC_C19,pi_C19,P_C19)%>%arrange(desc(pi_C19)) %>% slice(1:200) %>%select(-c(pi_C19))
write.csv(c1_sig,"each_group_sig_200/c1_sig.csv")
write.csv(c1_sig,"each_group_sig_200/c1_sig.csv",row.names = FALSE)
write.csv(c1_sig,"each_group_sig_200/c1_sig.csv",row.names = FALSE)
write.csv(c2_sig,"each_group_sig_200/c2_sig.csv",row.names = FALSE)
write.csv(c3_sig,"each_group_sig_200/c3_sig.csv",row.names = FALSE)
write.csv(c4_sig,"each_group_sig_200/c4_sig.csv",row.names = FALSE)
write.csv(c5_sig,"each_group_sig_200/c5_sig.csv",row.names = FALSE)
write.csv(c6_sig,"each_group_sig_200/c6_sig.csv",row.names = FALSE)
write.csv(c7_sig,"each_group_sig_200/c7_sig.csv",row.names = FALSE)
write.csv(c8_sig,"each_group_sig_200/c8_sig.csv",row.names = FALSE)
write.csv(c9_sig,"each_group_sig_200/c9_sig.csv",row.names = FALSE)
write.csv(c10_sig,"each_group_sig_200/c10_sig.csv",row.names = FALSE)
write.csv(c11_sig,"each_group_sig_200/c11_sig.csv",row.names = FALSE)
write.csv(c12_sig,"each_group_sig_200/c12_sig.csv",row.names = FALSE)
write.csv(c13_sig,"each_group_sig_200/c13_sig.csv",row.names = FALSE)
write.csv(c14_sig,"each_group_sig_200/c14_sig.csv",row.names = FALSE)
write.csv(c15_sig,"each_group_sig_200/c15_sig.csv",row.names = FALSE)
write.csv(c16_sig,"each_group_sig_200/c16_sig.csv",row.names = FALSE)
write.csv(c17_sig,"each_group_sig_200/c17_sig.csv",row.names = FALSE)
write.csv(c18_sig,"each_group_sig_200/c18_sig.csv",row.names = FALSE)
write.csv(c19_sig,"each_group_sig_200/c19_sig.csv",row.names = FALSE)
df1<-read.csv("exercise_paired.csv")
df1<-read.csv("exercise_paired.csv")
df2<-read.csv("exercise_second_order.csv")
df3<-read.csv("fasting_rest.csv")
c1<-data%>%select(ENSEMBL,logFC_C1,P_C1)%>%filter(ENSEMBL==df1$ENSEMBL)
c1_sig[as.factor(df1$ENSEMBL)]
c1_sig[as.factor(df1$ENSEMBL),]
head(c1_sig)
filter(c1_sig, ENSEMBL %in% df1$ENSEMBL)
c1<-filter(c1_sig, ENSEMBL %in% df1$ENSEMBL)
dim(c1)
head(df1)
c1<-data%>%select(ENSEMBL,logFC_C1,P_C1)%>%filter(ENSEMBL %in% df1$ENSEMBL)
dim(c1)
head(c1)
df1<-read.csv("exercise_paired.csv")
df2<-read.csv("exercise_second_order.csv")
df3<-read.csv("fasting_rest.csv")
head(df1)
c1<-data%>%select(ENSEMBL,logFC_C1,P_C1)%>%filter(ENSEMBL %in% df1$ENSEMBL)%>%slice(1:200)
dim(c1)
head(c1)
c1<-data%>%select(ENSEMBL,logFC_C1,P_C1)%>%filter(ENSEMBL %in% df1$ENSEMBL)%>%slice(1:200)
dim(c1)
head(c1,30)
c1<-data%>%select(ENSEMBL,logFC_C1,P_C1)%>%filter(ENSEMBL %in% df1$ENSEMBL)%>%slice(1:200)%>%arrange(df1$ENSEMBL)
c1<-data%>%select(ENSEMBL,logFC_C1,P_C1)%>%filter(ENSEMBL %in% df1$ENSEMBL)%>%slice(1:200)%>%arrange(ENSEMBL)
dim(c1)
head(c1,30)
c1<-data%>%select(ENSEMBL,logFC_C1,P_C1)%>%filter(ENSEMBL %in% df1$ENSEMBL)%>%slice(1:200)%>%arrange(ENSEMBL)
c1<-c1[match(ENSEMBL, df1$ENSEMBL),]
c1<-data%>%select(ENSEMBL,logFC_C1,P_C1)%>%filter(ENSEMBL %in% df1$ENSEMBL)%>%slice(1:200)%>%arrange(factor(ENSEMBL, levels = df1$ENSEMBL))
dim(c1)
head(c1,30)
c1<-data%>%select(ENSEMBL,logFC_C1,P_C1)%>%filter(ENSEMBL %in% df1$ENSEMBL)%>%slice(1:200)%>%arrange(factor(ENSEMBL, levels = df1$ENSEMBL))
c5<-data%>%select(ENSEMBL,logFC_C5,P_C5)%>%filter(ENSEMBL %in% df1$ENSEMBL)%>%slice(1:200)%>%arrange(factor(ENSEMBL, levels = df1$ENSEMBL))
c7<-data%>%select(ENSEMBL,logFC_C7,P_C7)%>%filter(ENSEMBL %in% df1$ENSEMBL)%>%slice(1:200)%>%arrange(factor(ENSEMBL, levels = df1$ENSEMBL))
write.csv(c1,"exercise_paired_sig_genes/c1.csv")
write.csv(c5,"exercise_paired_sig_genes/c5.csv")
write.csv(c7,"exercise_paired_sig_genes/c7.csv")
c1<-data%>%select(ENSEMBL,logFC_C1,P_C1)%>%filter(ENSEMBL %in% df1$ENSEMBL)%>%slice(1:200)%>%arrange(factor(ENSEMBL, levels = df1$ENSEMBL))
c5<-data%>%select(ENSEMBL,logFC_C5,P_C5)%>%filter(ENSEMBL %in% df1$ENSEMBL)%>%slice(1:200)%>%arrange(factor(ENSEMBL, levels = df1$ENSEMBL))
c7<-data%>%select(ENSEMBL,logFC_C7,P_C7)%>%filter(ENSEMBL %in% df1$ENSEMBL)%>%slice(1:200)%>%arrange(factor(ENSEMBL, levels = df1$ENSEMBL))
write.csv(c1,"exercise_paired_sig_genes/c1.csv",row.names = FALSE)
write.csv(c5,"exercise_paired_sig_genes/c5.csv",row.names=FALSE)
write.csv(c7,"exercise_paired_sig_genes/c7.csv",row.names=FALSE)
c10<-data%>%select(ENSEMBL,logFC_C10,P_C10)%>%filter(ENSEMBL %in% df2$ENSEMBL)%>%slice(1:200)%>%arrange(factor(ENSEMBL, levels = df2$ENSEMBL))
c18<-data%>%select(ENSEMBL,logFC_C18,P_C18)%>%filter(ENSEMBL %in% df2$ENSEMBL)%>%slice(1:200)%>%arrange(factor(ENSEMBL, levels = df2$ENSEMBL))
c19<-data%>%select(ENSEMBL,logFC_C19,P_C19)%>%filter(ENSEMBL %in% df2$ENSEMBL)%>%slice(1:200)%>%arrange(factor(ENSEMBL, levels = df2$ENSEMBL))
write.csv(c10,"exercise_paired_sig_genes/c10.csv",row.names = FALSE)
write.csv(c18,"exercise_paired_sig_genes/c18.csv",row.names=FALSE)
write.csv(c19,"exercise_paired_sig_genes/c19.csv",row.names=FALSE)
c10<-data%>%select(ENSEMBL,logFC_C10,P_C10)%>%filter(ENSEMBL %in% df2$ENSEMBL)%>%slice(1:200)%>%arrange(factor(ENSEMBL, levels = df2$ENSEMBL))
c18<-data%>%select(ENSEMBL,logFC_C18,P_C18)%>%filter(ENSEMBL %in% df2$ENSEMBL)%>%slice(1:200)%>%arrange(factor(ENSEMBL, levels = df2$ENSEMBL))
c19<-data%>%select(ENSEMBL,logFC_C19,P_C19)%>%filter(ENSEMBL %in% df2$ENSEMBL)%>%slice(1:200)%>%arrange(factor(ENSEMBL, levels = df2$ENSEMBL))
write.csv(c10,"exercise_paired_second_order_sig_genes/c10.csv",row.names = FALSE)
write.csv(c18,"exercise_paired_second_order_sig_genes/c18.csv",row.names=FALSE)
write.csv(c19,"exercise_paired_second_order_sig_genes/c19.csv",row.names=FALSE)
rm(list = ls())
library(dplyr)
library(knitr)
get_directory = function(){
args <- commandArgs(trailingOnly = FALSE)
file <- "--file="
rstudio <- "RStudio"
match <- grep(rstudio, args)
if(length(match) > 0){
return(dirname(rstudioapi::getSourceEditorContext()$path))
}else{
match <- grep(file, args)
if (length(match) > 0) {
return(dirname(normalizePath(sub(file, "", args[match]))))
}else{
return(dirname(normalizePath(sys.frames()[[1]]$ofile)))
}
}
}
setwd(get_directory())
d = read.csv(file = "comparisons_master_table.csv")
d = dplyr::select(d, ENSEMBL:gene_type,pi_C1_C5_C7,pi_C10_C18_C19,pi_C9_C12_C15,
chr:end_pos,logFC_C1:sig_pi_C19)
fasting_rest = arrange(d, desc(pi_C9_C12_C15))[1:300,] %>%
dplyr::select(ENSEMBL:SYMBOL,pi_C9_C12_C15,sig_pi_C9,sig_pi_C12,sig_pi_C15,chr,start_pos,end_pos)
exercise_second_order = arrange(d, desc(pi_C10_C18_C19))[1:300,] %>%
dplyr::select(ENSEMBL:SYMBOL,pi_C10_C18_C19,sig_pi_C10,sig_pi_C18,sig_pi_C19,chr,start_pos,end_pos)
exercise_paired = arrange(d, desc(pi_C1_C5_C7))[1:300,] %>%
dplyr::select(ENSEMBL:SYMBOL,pi_C1_C5_C7,sig_pi_C1,sig_pi_C5,sig_pi_C7,chr,start_pos,end_pos)
write.csv(fasting_rest, file = "fasting_rest.csv",
row.names = FALSE, quote = FALSE)
write.csv(exercise_second_order, file = "exercise_second_order.csv",
row.names = FALSE, quote = FALSE)
write.csv(exercise_paired, file = "exercise_paired.csv",
row.names = FALSE, quote = FALSE)
setwd(get_directory())
d = read.csv(file = "comparisons_master_table.csv")
d = dplyr::select(d, ENSEMBL:gene_type,pi_C1_C5_C7,pi_C10_C18_C19,pi_C9_C12_C15,
chr:end_pos,logFC_C1:sig_pi_C19)
fasting_rest = arrange(d, desc(pi_C9_C12_C15))[1:300,] %>%
dplyr::select(ENSEMBL:SYMBOL,pi_C9_C12_C15,sig_pi_C9,sig_pi_C12,sig_pi_C15,chr,start_pos,end_pos)
exercise_second_order = arrange(d, desc(pi_C10_C18_C19))[1:300,] %>%
dplyr::select(ENSEMBL:SYMBOL,pi_C10_C18_C19,sig_pi_C10,sig_pi_C18,sig_pi_C19,chr,start_pos,end_pos)
exercise_paired = arrange(d, desc(pi_C1_C5_C7))[1:300,] %>%
dplyr::select(ENSEMBL:SYMBOL,pi_C1_C5_C7,sig_pi_C1,sig_pi_C5,sig_pi_C7,chr,start_pos,end_pos)
write.csv(fasting_rest, file = "fasting_rest.csv",
row.names = FALSE, quote = FALSE)
write.csv(exercise_second_order, file = "exercise_second_order.csv",
row.names = FALSE, quote = FALSE)
write.csv(exercise_paired, file = "exercise_paired.csv",
row.names = FALSE, quote = FALSE)
knitr::opts_chunk$set(echo = TRUE)
chromosome_name<-c("chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18","chr19","chr20","chr21","chr22","chrX","chrY")
chromosome_length<-c(249250612,243199373,198022430,191154276,180915260,171115067,159138663,146364022,
141213431,135534747,135006516,133851895,115169878,107349540,102531392,90354753,
81195210,78077248,59128983,63025520,48129895,51304566,155270560,59373566)
human_chromosome<-data.frame(chromosome_name,chromosome_length)
head(human_chromosome)
# exercise_paired<-read.csv(file="CDP_RNAseq/Find_Significant_Genes/exercise_paired.csv")
exercise_paired<-read.csv(file="../exercise_paired.csv")
# exercise_second_order<-read.csv(file="CDP_RNAseq/Find_Significant_Genes/exercise_second_order.csv")
exercise_second_order<-read.csv(file="../exercise_second_order.csv")
# fasting_rest<-read.csv(file="CDP_RNAseq/Find_Significant_Genes/fasting_rest.csv")
fasting_rest<-read.csv(file="../fasting_rest.csv")
# cdp_compmultsign<-read.csv(file="CDP_RNAseq/Find_Significant_Genes/bin_matching/CDP_CompMultSign_list.csv")
cdp_compmultsign<-read.csv(file="CDP_CompMultSign_list.csv")
tibble(head(cdp_compmultsign))
find_bins<-function(chr,start,end,bin_size=200000){
if(is.na(chr)| is.na(start)|is.na(end)){
return(NA)
}
else{
#t<-paste0("chr",as.character(chr))
#chr_length<-human_chromosome[chromosome_name==t,]$chromosome_length
start_bin<-floor(start/bin_size)+1
end_bin<-floor(end/bin_size)+1
total_bin<-paste0(seq(start_bin,end_bin),collapse="&")
return(total_bin)
}
}
bin1<-mapply(find_bins, exercise_paired$chr, exercise_paired$start_pos, exercise_paired$end_pos)
bin2<-mapply(find_bins, exercise_second_order$chr, exercise_second_order$start_pos, exercise_second_order$end_pos)
bin3<-mapply(find_bins, fasting_rest$chr, fasting_rest$start_pos, fasting_rest$end_pos)
bin4<-mapply(find_bins, cdp_compmultsign$chr, cdp_compmultsign$pos, cdp_compmultsign$pos)
df1<-cbind(exercise_paired,bin=bin1)[,1:11]
df2<-cbind(exercise_second_order,bin=bin2)[,1:11]
df3<-cbind(fasting_rest,bin=bin3)[,1:11]
df4<-cbind(cdp_compmultsign,bin=bin4)
write.csv(df1,"CDP_RNAseq/Find_Significant_Genes/exercise_paired.csv", row.names = FALSE)
setwd("~/Desktop")
write.csv(df1,"CDP_RNAseq/Find_Significant_Genes/exercise_paired.csv", row.names = FALSE)
write.csv(df1,"CDP_RNAseq/Find_Significant_Genes/exercise_paired.csv", row.names = FALSE)
setwd("~/Desktop")
write.csv(df1,"CDP_RNAseq/Find_Significant_Genes/exercise_paired.csv", row.names = FALSE)
write.csv(df1,"CDP_RNAseq/Find_Significant_Genes/exercise_paired.csv", row.names = FALSE)
suppressPackageStartupMessages({
library(dplyr)
})
chromosome_name<-c("chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18","chr19","chr20","chr21","chr22","chrX","chrY")
chromosome_length<-c(249250612,243199373,198022430,191154276,180915260,171115067,159138663,146364022,
141213431,135534747,135006516,133851895,115169878,107349540,102531392,90354753,
81195210,78077248,59128983,63025520,48129895,51304566,155270560,59373566)
human_chromosome<-data.frame(chromosome_name,chromosome_length)
head(human_chromosome)
# exercise_paired<-read.csv(file="CDP_RNAseq/Find_Significant_Genes/exercise_paired.csv")
exercise_paired<-read.csv(file="../exercise_paired.csv")
suppressPackageStartupMessages({
library(dplyr)
})
chromosome_name<-c("chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18","chr19","chr20","chr21","chr22","chrX","chrY")
chromosome_length<-c(249250612,243199373,198022430,191154276,180915260,171115067,159138663,146364022,
141213431,135534747,135006516,133851895,115169878,107349540,102531392,90354753,
81195210,78077248,59128983,63025520,48129895,51304566,155270560,59373566)
human_chromosome<-data.frame(chromosome_name,chromosome_length)
head(human_chromosome)
exercise_paired<-read.csv(file="CDP_RNAseq/Find_Significant_Genes/exercise_paired.csv")
setwd("~/Desktop")
chromosome_name<-c("chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18","chr19","chr20","chr21","chr22","chrX","chrY")
chromosome_length<-c(249250612,243199373,198022430,191154276,180915260,171115067,159138663,146364022,
141213431,135534747,135006516,133851895,115169878,107349540,102531392,90354753,
81195210,78077248,59128983,63025520,48129895,51304566,155270560,59373566)
human_chromosome<-data.frame(chromosome_name,chromosome_length)
head(human_chromosome)
exercise_paired<-read.csv(file="CDP_RNAseq/Find_Significant_Genes/exercise_paired.csv")
chromosome_name<-c("chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18","chr19","chr20","chr21","chr22","chrX","chrY")
chromosome_length<-c(249250612,243199373,198022430,191154276,180915260,171115067,159138663,146364022,
141213431,135534747,135006516,133851895,115169878,107349540,102531392,90354753,
81195210,78077248,59128983,63025520,48129895,51304566,155270560,59373566)
human_chromosome<-data.frame(chromosome_name,chromosome_length)
head(human_chromosome)
exercise_paired<-read.csv(file="CDP_RNAseq/Find_Significant_Genes/exercise_paired.csv")
exercise_paired<-read.csv(file="CDP_RNAseq/Find_Significant_Genes/exercise_paired.csv")
setwd("~/Desktop/CDP_RNAseq/Find_Significant_Genes")
chromosome_name<-c("chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18","chr19","chr20","chr21","chr22","chrX","chrY")
chromosome_length<-c(249250612,243199373,198022430,191154276,180915260,171115067,159138663,146364022,
141213431,135534747,135006516,133851895,115169878,107349540,102531392,90354753,
81195210,78077248,59128983,63025520,48129895,51304566,155270560,59373566)
human_chromosome<-data.frame(chromosome_name,chromosome_length)
head(human_chromosome)
exercise_paired<-read.csv(file="exercise_paired.csv")
chromosome_name<-c("chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18","chr19","chr20","chr21","chr22","chrX","chrY")
chromosome_length<-c(249250612,243199373,198022430,191154276,180915260,171115067,159138663,146364022,
141213431,135534747,135006516,133851895,115169878,107349540,102531392,90354753,
81195210,78077248,59128983,63025520,48129895,51304566,155270560,59373566)
human_chromosome<-data.frame(chromosome_name,chromosome_length)
head(human_chromosome)
exercise_paired<-read.csv(file="exercise_paired")
chromosome_name<-c("chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18","chr19","chr20","chr21","chr22","chrX","chrY")
chromosome_length<-c(249250612,243199373,198022430,191154276,180915260,171115067,159138663,146364022,
141213431,135534747,135006516,133851895,115169878,107349540,102531392,90354753,
81195210,78077248,59128983,63025520,48129895,51304566,155270560,59373566)
human_chromosome<-data.frame(chromosome_name,chromosome_length)
head(human_chromosome)
exercise_paired<-read.csv(file="exercise_paired.csv")
getwd()
chromosome_name<-c("chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18","chr19","chr20","chr21","chr22","chrX","chrY")
chromosome_length<-c(249250612,243199373,198022430,191154276,180915260,171115067,159138663,146364022,
141213431,135534747,135006516,133851895,115169878,107349540,102531392,90354753,
81195210,78077248,59128983,63025520,48129895,51304566,155270560,59373566)
human_chromosome<-data.frame(chromosome_name,chromosome_length)
head(human_chromosome)
exercise_paired<-read.csv(file="exercise_paired.csv")
exercise_paired<-read.csv(file="exercise_paired.csv")
